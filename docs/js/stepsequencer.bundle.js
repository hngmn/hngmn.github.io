(()=>{"use strict";var e,t={5785:(e,t,n)=>{var r=n(7294),a=n(3935),s=n(9657),i=n(117),o=(n(9335),n(3379)),l=n.n(o),u=n(7795),c=n.n(u),m=n(695),d=n.n(m),p=n(9216),f=n.n(p),h=n(4763),g={styleTagTransform:function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}},setAttributes:function(e){var t=n.nc;t&&e.setAttribute("nonce",t)},insert:function(e){var t=d()("head");if(!t)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");t.appendChild(e)}};g.domAPI=c(),g.insertStyleElement=f(),l()(h.Z,g),h.Z&&h.Z.locals&&h.Z.locals;var y=n(4399),b=n(2222);function v(e,t,n){t in e.byId||e.allIds.push(t),e.byId[t]=n}function w(e,t,n,r){const a=[];for(let s=0;s<e;s++){a.push([]);for(let e=0;e<t;e++){a[s].push([]);for(let t=0;t<n;t++)a[s][e].push(r)}}return a}var I=n(3029),x=n(2831);const k="MyDB",E=1,N="instruments",C="instrumentNames",P="instrumentNames",S="sequencerInstruments",A="sequencerInstruments";let O;async function T(e){let t;O=O||await async function(){return await I.X3(k,E,{upgrade(e,t,n,r){console.debug(`upgrade o:${t} n:${n}`),e.createObjectStore(N,{keyPath:"uuid"}).createIndex(P,"name"),e.createObjectStore(C,{keyPath:"uuid"}).createIndex(P,"name"),e.createObjectStore(S),r.objectStore(S).put([],A)},blocked(){console.debug("blocked")},blocking(){console.debug("blocking")},terminated(){console.debug("terminated")}})}();try{t=await e(O)}catch(e){return(0,x.UG)(e)}return void 0===t?(0,x.UG)(new Error("got undefined")):(0,x.Ok)(t)}async function q(e,t){return await T((async n=>{const r=await n.get(e,t);return console.debug(`get store=${e}, result=`,r),r}))}async function B(e,t,n){return await T((async r=>{const a=await r.put(e,t,n);return console.debug(`put store=${e}, item=`,t),a}))}async function j(e,t){return await T((async n=>{const r=await n.delete(e,t);return console.debug("delete store=",e,`, key=${t}`),r}))}async function $(e,t){return await T((async n=>{const r=await n.getAllFromIndex(e,t);return console.debug(`getAllFromIndex store=${e}, index=${t}, result=`,r),r}))}const L={getInstrument:async function(e){return await q(N,e)},putInstrument:async function(e){return await B(C,{uuid:e.uuid,name:e.name}),await B(N,e)},getAllInstruments:async function(){return await $(N,P)},getAllInstrumentIds:async function(){return await async function(e,t){return await T((async n=>{const r=await n.getAllKeysFromIndex(e,t);return console.debug(`getAllKeysFromIndex store=${e}, index=${t}, result=`,r),r}))}(N,P)},getAllInstrumentNames:async function(){return await $(C,P)},deleteInstrument:async function(e){return await j(C,e),await j(N,e),x.Ok.EMPTY},getSequencerInstruments:async function(){return await q(S,A)},putSequencerInstruments:async function(e){return await B(S,e,A)}};var D=n(1950);let U,F={};const R={init:async function(){await D.start(),D.Transport.bpm.value=99,D.Transport.setLoopPoints(0,"2m"),D.Transport.loop=!0},getCurrentTime:function(){return D.now()},getTone:function(){return D},addInstrumentToScheduler:function(e){F[e.getUuid()]=e},removeInstrumentFromScheduler:function(e){const t=F[e];return delete F[e],t},hasInstrument:function(e){return e in F},getInstrument:function(e){return F[e]},setUpLoops:function(e,t,n,r,a){U&&function(){for(let e=0;e<U.length;e++)for(let t=0;t<U[0].length;t++)for(let n=0;n<U[0][0].length;n++)D.Transport.clear(U[e][t][n])}(),U=w(e,t,n,-1);for(let s=0;s<e;s++)for(let e=0;e<t;e++)for(let t=0;t<n;t++)U[s][e][t]=D.Transport.schedule((n=>{const i=[s,e,t];r(i).forEach((e=>F[e].schedule(n))),D.Draw.schedule((()=>{a(i)}),n)}),`${s}:${e}:${t}`)},setLoopBars:function(e){D.Transport.setLoopPoints(0,`${e}m`)},playInstrument:function(e){e in F?F[e].schedule("+0.05"):console.error(`instrument ${e} not loaded yet`)},play:function(){D.Transport.start("+0.05")},pause:function(){D.Transport.stop("+0.05")},setTempo:function(e){D.Transport.bpm.value=e}};var M=n(4586);function z(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class V{constructor(e,t){z(this,"name",void 0),z(this,"value",void 0),z(this,"update",void 0),this.name=e.name,this.value=e.value,this.update=t}getName(){return this.name}setName(e){this.name=e}getValue(){return this.value}setValue(e){this.value=e,this.update(e)}}class Z extends V{constructor(e,t){super(e,(e=>t(e))),z(this,"kind",void 0),z(this,"min",void 0),z(this,"max",void 0),z(this,"step",void 0),this.kind="slider",this.name=e.name,this.min=e.min,this.max=e.max,this.value=e.value,this.step=e.step}toConfigObject(){return{kind:this.kind,name:this.name,value:this.value,min:this.min,max:this.max,step:this.step}}}class G extends V{constructor(e,t){super(e,(e=>t(e))),z(this,"kind",void 0),this.kind="switch"}toConfigObject(){return{kind:this.kind,name:this.name,value:this.value}}}function _(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class K{constructor(e,t={}){_(this,"kind",void 0),_(this,"uuid",void 0),_(this,"name",void 0),_(this,"params",void 0),_(this,"channel",void 0),this.uuid=t.uuid?t.uuid:(0,M.Z)(),this.name=t.name?t.name:this.uuid,this.params={byId:{},allIds:[]},this.channel=new D.Channel(0,0),this.channel.toDestination();const n=new Z({kind:"slider",name:"volume",min:-36,max:12,value:0,step:.1},(e=>this.channel.set({volume:e}))),r=new Z({kind:"slider",name:"pan",min:-1,max:1,value:0,step:.1},(e=>this.channel.set({pan:e})));v(this.params,n.getName(),n),v(this.params,r.getName(),r);for(const t of e)v(this.params,t.getName(),t)}getKind(){return this.kind}getUuid(){return this.uuid}getName(){return this.name}setName(e){this.name=e}getAllParameterNames(){return this.params.allIds}getParameter(e){return this.params.byId[e]}getParameterConfig(e){return this.params.byId[e].toConfigObject()}getParameterValue(e){return this.params.byId[e].getValue()}setParameterValue(e,t){this.params.byId[e].setValue(t)}getAllParameterConfigs(){return this.params.allIds.map((e=>this.params.byId[e].toConfigObject()))}setSolo(e){this.channel.solo=e}setMute(e){this.channel.mute=e}}function Y(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class W extends K{constructor(e,t={}){t.name||(t.name="string"==typeof e?W.splitFilename(e):"buffer"),super([new Z({kind:"slider",name:"lowpassHz",min:40,max:22e3,value:15e3,step:10},(e=>this.lowpass.set({frequency:e}))),new Z({kind:"slider",name:"distortion",min:0,max:1,value:0,step:.1},(e=>this.distortion.set({distortion:e}))),new Z({kind:"slider",name:"playbackRate",min:.1,max:3,value:1,step:.1},(e=>{this.player.playbackRate=e})),new G({kind:"switch",name:"reverse",value:!1},(e=>{this.player.reverse=e}))],t),Y(this,"kind",void 0),Y(this,"player",void 0),Y(this,"distortion",void 0),Y(this,"lowpass",void 0),this.kind="TonePlayer",this.lowpass=new D.Filter(15e3,"lowpass").connect(this.channel),this.distortion=new D.Distortion(0).connect(this.lowpass),this.player=new D.Player(e).connect(this.distortion)}schedule(e){this.player.start(e)}toDBObject(){const e=this.player.buffer.get();if(!e)throw console.error("audioBuffer undefined"),Error("audioBuffer undefined");const t=this.player.buffer.toArray().buffer;return{kind:this.kind,uuid:this.getUuid(),name:this.getName(),screenName:"TODO",parameters:this.getAllParameterConfigs(),buf:t,nChannels:e.numberOfChannels,length:e.length,sampleRate:e.sampleRate}}static async from(e){const t=new Float32Array(e.buf),n=D.context.createBuffer(e.nChannels,e.length,e.sampleRate);for(let r=0;r<e.nChannels;r++)n.copyToChannel(t,r);const r=new W(n,{uuid:e.uuid,name:e.name});return await D.loaded(),r}static async fromFile(e){const t=new W(URL.createObjectURL(e),{name:e.name});return await D.loaded(),t}static splitFilename(e){const t=e.split("/");return t[t.length-1]}}function H(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class J extends K{constructor(e={}){super([new Z({kind:"slider",name:"distortion",min:0,max:1,value:0,step:.1},(e=>this.distortion.set({distortion:e})))],{...e,name:e.name?e.name:"ToneSynth"}),H(this,"kind",void 0),H(this,"synth",void 0),H(this,"distortion",void 0),this.distortion=new D.Distortion(0).connect(this.channel),this.synth=(new D.Synth).connect(this.distortion),this.kind="ToneSynth"}schedule(e){this.synth.triggerAttackRelease("C2","8n",e)}toDBObject(){return{kind:this.kind,uuid:this.getUuid(),name:this.getName(),screenName:"TODO",parameters:this.getAllParameterConfigs()}}static async from(e){return new J({})}}function Q(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class X extends K{constructor(e,t,n={}){function r(e){return e.getAllParameterNames().map((t=>(e.getParameter(t).setName(`${e.getName()}-${t}`),e.getParameter(t))))}n.name||(n.name=`Djx-${e.getName()}-${t.getName()}`),super([...r(e),...r(t)],n),Q(this,"kind",void 0),Q(this,"instrument1",void 0),Q(this,"instrument2",void 0),Q(this,"distribution",void 0),this.kind="Disjunction",this.instrument1=e,this.instrument2=t,this.distribution=[.8,.2]}schedule(e){this.pickRandom([this.instrument1,this.instrument2],this.distribution).schedule(e)}pickRandom(e,t){const n=t[0];return Math.random()<n?e[0]:e[1]}toDBObject(){return{kind:this.kind,uuid:this.getUuid(),name:this.getName(),screenName:"TODO",parameters:this.getAllParameterConfigs(),i1:this.instrument1.toDBObject(),i2:this.instrument2.toDBObject()}}static async from(e){const t=await ee(e.i1);if(t.err)throw console.error("Got error creating i1: ",t.val),t.val;const n=t.unwrap(),r=await ee(e.i2);if(r.err)throw console.error("Got error creating i2: ",r.val),r.val;const a=r.unwrap();return new X(n,a,{uuid:e.uuid,name:e.name})}}async function ee(e){let t;switch(e.kind){case"ToneSynth":return t=await J.from(e),(0,x.Ok)(t);case"TonePlayer":return t=await W.from(e),(0,x.Ok)(t);case"Conjunction":return t=await ne.from(e),(0,x.Ok)(t);case"Disjunction":return t=await X.from(e),(0,x.Ok)(t);default:return console.error("Not recognized IInstrument"),(0,x.UG)(new Error(`Unrecognized instrument type: ${e}`))}}function te(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class ne extends K{constructor(e,t,n={}){function r(e){return e.getAllParameterNames().map((t=>(e.getParameter(t).setName(`${e.getName()}-${t}`),e.getParameter(t))))}n.name||(n.name=`Cjx-${e.getName()}-${t.getName()}`),super([...r(e),...r(t)],n),te(this,"kind",void 0),te(this,"instrument1",void 0),te(this,"instrument2",void 0),this.kind="Conjunction",this.instrument1=e,this.instrument2=t}schedule(e){this.instrument1.schedule(e),this.instrument2.schedule(e)}toDBObject(){return{kind:this.kind,uuid:this.getUuid(),name:this.getName(),screenName:"TODO",parameters:this.getAllParameterConfigs(),i1:this.instrument1.toDBObject(),i2:this.instrument2.toDBObject()}}static async from(e){const t=await ee(e.i1);if(t.err)throw console.error("Got error creating i1: ",t.val),t.val;const n=t.unwrap(),r=await ee(e.i2);if(r.err)throw console.error("Got error creating i2: ",r.val),r.val;const a=r.unwrap();return new ne(n,a,{uuid:e.uuid,name:e.name})}}const re=(0,y.hg)("instruments/fetchDbInstrumentNames",(async()=>{const e=await L.getAllInstrumentNames();if(e.err)throw console.error("got error fetching db names"),e.val;return e.unwrap()})),ae=(0,y.hg)("instruments/fetchSequencerInstruments",(async(e,{dispatch:t})=>{const n=await L.getSequencerInstruments();if(n.err)throw console.error("err getting sequencer instruments",n.val),n.val;const r=n.unwrap();return t(ce(r)),r})),se=(0,y.hg)("instruments/putLocalInstrument",(async(e,{dispatch:t})=>(R.addInstrumentToScheduler(e),t(me(e)),{id:e.getUuid(),name:e.getName()}))),ie=(0,y.oM)({name:"instruments",initialState:{loadedInstruments:{byId:{},allIds:[]},availableInstrumentNames:{byId:{},allIds:[]},sequencerInstrumentIds:[]},reducers:{instrumentStaged:{reducer(e,t){const{id:n,name:r,params:a}=t.payload;e.sequencerInstrumentIds.push(n),e.loadedInstruments.allIds.push(n),e.loadedInstruments.byId[n]={id:n,name:r,muted:!1,solo:!1,params:a}},prepare(e){return{payload:(n=e,{id:n.getUuid(),name:n.getName(),solo:!1,muted:!1,params:(t=n.getAllParameterNames().map(n.getParameterConfig.bind(n)).map((e=>[e.name,e])),{byId:Object.fromEntries(t),allIds:t.map((e=>e[0]))})})};var t,n}},instrumentUnstaged:(e,t)=>{const n=t.payload;delete e.loadedInstruments.byId[n],e.loadedInstruments.allIds.splice(e.loadedInstruments.allIds.indexOf(n),1),e.sequencerInstrumentIds.splice(e.sequencerInstrumentIds.indexOf(n),1)},instrumentDeleted:(e,t)=>{const n=t.payload;delete e.availableInstrumentNames.byId[n],e.availableInstrumentNames.allIds.splice(e.availableInstrumentNames.allIds.indexOf(n),1)},instrumentParameterUpdated:{reducer(e,t){const{instrumentId:n,parameterName:r,value:a}=t.payload;e.loadedInstruments.byId[n].params.byId[r].value=a},prepare:(e,t,n)=>({payload:{instrumentId:e,parameterName:t,value:n}})},instrumentRenamed:{reducer(e,t){const{instrumentId:n,newScreenName:r}=t.payload;e.loadedInstruments.byId[n].name=r,e.availableInstrumentNames.byId[n]=r},prepare:(e,t)=>({payload:{instrumentId:e,newScreenName:t}})},instrumentSolo:{reducer(e,t){const{id:n,value:r}=t.payload;e.loadedInstruments.byId[n].solo=r},prepare:(e,t)=>({payload:{id:e,value:t}})},instrumentMuted:{reducer(e,t){const{id:n,value:r}=t.payload;e.loadedInstruments.byId[n].muted=r},prepare:(e,t)=>({payload:{id:e,value:t}})}},extraReducers:e=>{e.addCase(re.fulfilled,((e,t)=>{t.payload.forEach((t=>{e.availableInstrumentNames.allIds.push(t.uuid),e.availableInstrumentNames.byId[t.uuid]=t.name}))})).addCase(se.fulfilled,((e,t)=>{const{id:n,name:r}=t.payload;e.availableInstrumentNames.allIds.push(n),e.availableInstrumentNames.byId[n]=r}))}});function oe(e){return async function(t,n){const r=Array.from(Ie(n()));t(ie.actions.instrumentUnstaged(e)),console.debug("unstageInstrument: current sequencer=",r);const a=r.indexOf(e);return a>-1?r.splice(a,1):console.error(`id ${e} not found in array:`,r),console.debug(`unstageInstrument: removing iid=${e}, new sequencerInstruments=`,r),await t(de(r)),r}}function le(e,t,n){return async function(r){R.getInstrument(e).setParameterValue(t,n),await r(ie.actions.instrumentParameterUpdated(e,t,n))}}const ue=(0,y.hg)("instruments/playInstrument",(async e=>{await pe(e),R.playInstrument(e)}));function ce(e){return async function(t,n){const r=Ie(n());console.debug("setSequencerInstrumentsInStore: current=",r,"setting to: ",e),r.filter((t=>!e.includes(t))).forEach((async e=>{t(ie.actions.instrumentUnstaged(e))})),e.filter((e=>!r.includes(e))).forEach((async e=>{const n=await pe(e);t(ie.actions.instrumentStaged(n)),console.debug(`adding iid=${e}`)}))}}function me(e){return console.debug("putInstrumentToDb",e),async function(){const t=e.toDBObject(),n=await L.putInstrument(t);if(n.err)throw console.error("putInstrumentToDb: got error writing instrument",n.val),n.val;return n.unwrap()}}function de(e){return console.debug("putSequencerInstrumentsToDb",e),async function(){const t=await L.putSequencerInstruments(e);if(t.err)throw console.error("putSequencerInstrumentsToDb: got error writing instrument",t.val),t.val}}async function pe(e){if(function(e){return R.hasInstrument(e)}(e))return R.getInstrument(e);const t=await L.getInstrument(e);if(t.err)throw console.error("db failed loading instrument",t.val),t.val;const n=t.unwrap(),r=await ee(n);if(r.err)throw console.error("dboToInstrument failed",t.val),t.val;const a=r.unwrap();return R.addInstrumentToScheduler(a),a}const fe=e=>e.instruments.loadedInstruments.allIds,he=((0,b.P1)([fe,e=>e.instruments.loadedInstruments.byId],((e,t)=>e.map((e=>t[e])))),(e,t)=>e.instruments.loadedInstruments.byId[t].name),ge=(e,t)=>e.instruments.loadedInstruments.byId[t].params.allIds,ye=(e,t,n)=>e.instruments.loadedInstruments.byId[t].params.byId[n],be=(e,t)=>e.instruments.loadedInstruments.byId[t].solo,ve=(e,t)=>e.instruments.loadedInstruments.byId[t].muted,we=e=>e.instruments.availableInstrumentNames.allIds.map((t=>({uuid:t,name:e.instruments.availableInstrumentNames.byId[t]}))),Ie=e=>e.instruments.sequencerInstrumentIds,xe=e=>e.instruments.sequencerInstrumentIds.map((t=>({uuid:e.instruments.loadedInstruments.byId[t].id,name:e.instruments.loadedInstruments.byId[t].name}))),{instrumentStaged:ke,instrumentUnstaged:Ee}=ie.actions,Ne=ie.reducer;var Ce=n(3894);const Pe=(0,y.oM)({name:"sequencer",initialState:{isPlaying:!1,nBars:2,beatsPerBar:4,padsPerBeat:4,tempo:99,currentNote:[0,0,0],pads:w(2,4,4,{}),rtms:{}},reducers:{play:e=>{e.isPlaying=!0},pause:e=>{e.isPlaying=!1},setTempo:(e,t)=>{e.tempo=t.payload},setNBars:(e,t)=>{e.nBars=t.payload},setCurrentNote:(e,t)=>{e.currentNote=t.payload},padClick:{reducer(e,t){const{id:n,note:r}=t.payload,[a,s,i]=r;e.pads[a][s][i][n]=!e.pads[a][s][i][n],e.rtms[n].synced=!1},prepare:(e,t)=>({payload:{id:e,note:t}})},setRtmInput:{reducer(e,t){const{instrumentId:n,rtm:r}=t.payload;e.rtms[n].input=r},prepare:(e,t)=>({payload:{instrumentId:e,rtm:t}})},compileRtm:(e,t)=>{const n=t.payload,r=e.rtms[n].input,{nBars:a,beatsPerBar:s,padsPerBeat:i}=e,o=function(e,t){if(""===e)return(0,x.Ok)(new Array(t).fill(!1));let n;try{n=Ce.parse(e)}catch(e){return(0,x.UG)(e)}return n.length>t?n=n.slice(0,t):n.concat(new Array(t-n.length).fill(!1)),(0,x.Ok)(n)}(r,function(e,t,n){return e*t*n}(a,s,i));if(o.err)return e.rtms[n].valid=!1,void(e.rtms[n].errorMessage=o.val.message);e.rtms[n].valid=!0,e.rtms[n].errorMessage="",e.rtms[n].synced=!0;const l=o.val;let u=0;for(let t=0;t<a;t++)for(let r=0;r<s;r++)for(let a=0;a<i;a++)e.pads[t][r][a][n]=l[u++]},clearAllPads:e=>{const{nBars:t,beatsPerBar:n,padsPerBeat:r}=e;for(let a=0;a<t;a++)for(let t=0;t<n;t++)for(let n=0;n<r;n++)Object.keys(e.pads[a][t][n]).forEach((r=>{e.pads[a][t][n][r]=!1}));for(const t of Object.keys(e.rtms))e.rtms[t].synced=!1}},extraReducers:e=>{e.addCase(ke,((e,t)=>{const{nBars:n,beatsPerBar:r,padsPerBeat:a}=e,{id:s}=t.payload;for(let t=0;t<n;t++)for(let n=0;n<r;n++)for(let r=0;r<a;r++)e.pads[t][n][r][s]=!1;e.rtms[s]={input:"",synced:!1,valid:!0,errorMessage:""}})).addCase(Ee,((e,t)=>{const{nBars:n,beatsPerBar:r,padsPerBeat:a}=e,s=t.payload;for(let t=0;t<n;t++)for(let n=0;n<r;n++)for(let r=0;r<a;r++)delete e.pads[t][n][r][s];delete e.rtms[s]}))}});function Se(e){e(Pe.actions.play()),R.play()}function Ae(e){e(Pe.actions.pause()),R.pause()}const Oe=e=>e.sequencer.nBars,Te=e=>e.sequencer.beatsPerBar,qe=e=>e.sequencer.padsPerBeat,Be=e=>e.sequencer.currentNote;const je=(e,t,[n,r,a])=>e.sequencer.pads[n][r][a][t],$e=(e,t)=>(e=>Object.keys(e.sequencer.pads[0][0][0]))(e).filter((n=>je(e,n,t))),Le=(e,t)=>e.sequencer.rtms[t],{setCurrentNote:De,padClick:Ue,clearAllPads:Fe,setRtmInput:Re,compileRtm:Me}=Pe.actions,ze=Pe.reducer,Ve=(0,y.xC)({reducer:{sequencer:ze,instruments:Ne}}),Ze=()=>(0,s.I0)();function Ge(e){const{status:t,ready:n,children:a}=e;return n?a:r.createElement("div",{className:"loading"},r.createElement("p",null,"Loading..."),r.createElement("p",null,t?`Status=${t}`:""))}var _e=n(4184),Ke=n.n(_e);function Ye(e){const{isPlaying:t,onClick:n}=e,a=Ke()("playButton");return r.createElement("button",{className:a,onClick:n},r.createElement("span",null,t?"Pause":"Play"))}var We=n(9936);function He(){const e=(0,s.v9)(Oe),t=2===e,n=Ze();return r.createElement("label",{className:Ke()("switch","nBars")},r.createElement("span",null,"nBars=",e),r.createElement(We.default,{checked:t,onChange:e=>n(function(e){return function(t){t(Pe.actions.setNBars(e)),R.setLoopBars(e)}}(e?2:1))}))}function Je(){return Je=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},Je.apply(this,arguments)}function Qe(e){const{name:t,min:n=0,max:a=1,value:s=.5,step:i=.1,onInput:o,classNames:l=[]}=e,u=Ke()("slider",t,...l);return r.createElement("div",{className:u},r.createElement("label",{htmlFor:t},t," (",s,")"),r.createElement("input",{name:t,id:t,type:"range",min:n,max:a,value:s,step:i,onInput:e=>o(parseFloat(e.target.value))}))}function Xe(e){return r.createElement(Qe,Je({classNames:["instrumentParameter"],onInput:e.onInput},(0,s.v9)(e.selector)))}function et(){const e=(0,s.v9)(Oe),t=(0,s.v9)(Te),n=(0,s.v9)(qe),a=(0,s.v9)((e=>e.sequencer.tempo)),i=Ze();return r.useEffect((()=>{R.setUpLoops(e,t,n,(e=>$e(Ve.getState(),e)),(e=>i(De(e))))}),[]),r.createElement(r.Fragment,null,r.createElement(Qe,{classNames:["bpm"],name:"bpm",min:10,max:200,value:a,step:1,onInput:e=>i(function(e){return function(t){t(Pe.actions.setTempo(e)),R.setTempo(e)}}(e))}),r.createElement(He,null))}function tt(){const e=(0,s.v9)((e=>e.sequencer.isPlaying)),t=Ze();return r.createElement("section",{className:"sequencerControls"},r.createElement(et,null),r.createElement(Ye,{isPlaying:e,onClick:()=>t(e?Ae:Se)}),r.createElement("button",{className:Ke()("clearAll"),onClick:()=>t(Fe())},"Clear All"))}let nt;function rt(e,t){switch(t.type){case"keyDown":e[t.payload]=!0;break;case"keyUp":e[t.payload]=!1}return e}(nt||(nt={})).actions={KEYDOWN:e=>({type:"keyDown",payload:e}),KEYUP:e=>({type:"keyUp",payload:e})};const at=(e,t)=>{const n=e.reduce(((e,t)=>(e[t]=!1,e)),{}),[a,s]=r.useReducer(rt,n),i=r.useCallback((t=>{const{key:n,target:r,repeat:i}=t;i||e.includes(n)&&(a[n]||s(nt.actions.KEYDOWN(n)))}),[e,a]),o=r.useCallback((n=>{const{key:r,target:i}=n;e.includes(r)&&a[r]&&(s(nt.actions.KEYUP(r)),t())}),[e,a]);r.useEffect((()=>(window.addEventListener("keydown",i,!0),()=>window.removeEventListener("keydown",i,!0))),[i]),r.useEffect((()=>(window.addEventListener("keyup",o,!0),()=>window.removeEventListener("keyup",o,!0))),[o])};function st(e){const{instrumentId:t,editable:n=!0}=e,[a,i]=r.useState(!1),o=(0,s.v9)((e=>he(e,t))),l=Ze(),[u,c]=r.useState(o),m=r.useRef(null);return at(["Enter"],(()=>{a&&m.current.blur()})),a?r.createElement("input",{className:Ke()("instrumentLabel","edit"),type:"text",autoFocus:!0,ref:m,onFocus:e=>e.target.select(),onChange:e=>c(e.target.value),onBlur:e=>{var n,r;l((n=t,r=u,async function(e){const t=R.getInstrument(n);t.setName(r),await Promise.all([e(me(t)),e(ie.actions.instrumentRenamed(n,r))])})),i(!1)},value:u}):r.createElement("span",{className:Ke()("instrumentLabel"),onDoubleClick:()=>{n&&i(!0)}},o)}function it(e){const{instrumentId:t,keyboardShortcut:n="s"}=e,a=Ze(),s=Ke()("instrumentPlayButton");return at([n],(()=>{"keyboardShortcut"in e&&a(ue(t))})),r.createElement("button",{className:s,onClick:()=>a(ue(t))},"sample")}function ot(e){const{instrumentId:t,onEdit:n}=e,a=(0,s.v9)((e=>be(e,t))),i=(0,s.v9)((e=>ve(e,t))),o=Ze(),l=Ke()("quickControls");return r.createElement("section",{className:l},r.createElement("button",{className:Ke()("quickControlButton","solo",a?"on":"off"),onClick:()=>{return o((e=t,console.debug("solo ",e),async function(t,n){const r=!be(n(),e),a=R.getInstrument(e);a.setSolo(r),t(ie.actions.instrumentSolo(e,r)),a.setMute(!1),t(ie.actions.instrumentMuted(e,!1))}));var e}},"solo"),r.createElement("button",{className:Ke()("quickControlButton","mute",i?"on":"off"),onClick:()=>{return o((e=t,console.debug("mute ",e),async function(t,n){const r=!ve(n(),e),a=R.getInstrument(e);a.setMute(r),t(ie.actions.instrumentMuted(e,r)),a.setSolo(!1),t(ie.actions.instrumentSolo(e,!1))}));var e}},"mute"),r.createElement("button",{className:Ke()("quickControlButton","edit"),onClick:n},"edit"))}function lt(e){const{instrumentId:t,parameterName:n}=e,a=(0,s.v9)((e=>ye(e,t,n))),i=Ze();return r.createElement("div",{className:Ke()("switch",n)},r.createElement("label",{htmlFor:n},n),r.createElement(We.default,{name:n,checked:a.value,onChange:e=>i(le(t,n,e))}))}function ut(e){const{instrumentId:t,parameterName:n}=e,a=(0,s.v9)((e=>ye(e,t,n))),i=Ze();switch(a.kind){case"slider":return r.createElement(Xe,{selector:e=>ye(e,t,n),onInput:e=>i(le(t,n,e))});case"switch":return r.createElement(lt,{instrumentId:t,parameterName:a.name});default:throw new Error("unexpected param kind")}}function ct(e){const{instrumentId:t}=e,n=(0,s.v9)((e=>ge(e,t)));return r.createElement("section",{className:Ke()("instrumentParameters")},n.map((e=>r.createElement(ut,{key:e,instrumentId:t,parameterName:e}))))}var mt=n(6486);const dt=250;function pt(e){const{instrumentId:t}=e,{input:n,synced:a,valid:i,errorMessage:o}=(0,s.v9)((e=>Le(e,t))),l=Ze(),u=(0,mt.debounce)((()=>{l(Me(t))}),dt);return r.createElement("section",{className:Ke()("rtmBox")},r.createElement("span",null,r.createElement("label",null,"RTM"),r.createElement("input",{className:Ke()("rtmInput",i?"valid":"invalid"),value:n,type:"text",onChange:e=>{const n=e.target.value;l(Re(t,n)),u()}}),a?"synced":"unsynced"))}function ft(e){const{instrumentId:t,closePanel:n}=e,a=Ke()("fullControlPanel"),s=r.useRef(null);return function(e,t){function n(n){e.current&&!e.current.contains(n.target)&&t(n)}r.useEffect((()=>(document.addEventListener("mousedown",n),()=>document.removeEventListener("mousedown",n))),[e])}(s,n),r.createElement("section",{ref:s,className:a},r.createElement("span",null,r.createElement(st,{instrumentId:t,editable:!0}),r.createElement(it,{instrumentId:t,keyboardShortcut:"s"})),r.createElement(pt,{instrumentId:t}),r.createElement(ct,{instrumentId:t}))}function ht(e){const t=document.querySelector("#stepsequencer_container");return a.createPortal(e.children,t)}function gt(e){const{instrumentId:t}=e,[n,a]=r.useState(!1),s=Ze(),i=Ke()("track","quickControlPanel");return r.createElement("section",{className:i},r.createElement("button",{className:Ke()("removeInstrumentButton"),onClick:e=>s(oe(t))},"x"),r.createElement(st,{instrumentId:t,editable:!1}),r.createElement(it,{instrumentId:t}),r.createElement(ot,{instrumentId:t,onEdit:()=>a(!0)}),n?r.createElement(ht,null,r.createElement(ft,{instrumentId:t,closePanel:()=>a(!1)})):null)}function yt(e){return[...bt(0,e)]}function*bt(e,t,n=1){for(let r=e;r<t;r+=n)yield r}function vt(e){const{instrumentId:t,note:n}=e,a=(0,s.v9)((e=>he(e,t))),i=(0,s.v9)((e=>je(e,t,n))),o=(0,s.v9)(Be),l=o[0]===n[0]&&o[1]===n[1]&&o[2]===n[2],u=Ze(),c=Ke()("pad",i?"on":"off",l?"active":"inactive");return r.createElement("button",{"aria-label":`${a} pad${n.join("")}`,className:c,onClick:()=>u(Ue(t,n))})}function wt(e){const{instrumentId:t}=e,n=(0,s.v9)(Oe),a=(0,s.v9)(Te),i=(0,s.v9)(qe),o=Ke()("track","pads");return r.createElement("section",{className:o,style:{gridTemplateColumns:`repeat(${n}, 1fr)`}},yt(n).map((e=>r.createElement("span",{key:`bar${e}`,className:Ke()("bar"),style:{gridTemplateColumns:`repeat(${a}, 1fr)`}},yt(a).map((n=>r.createElement("span",{key:`beat${n}`,className:Ke()("beat"),style:{gridTemplateColumns:`repeat(${i}, 1fr)`}},yt(i).map((a=>r.createElement(vt,{key:`${a}`,instrumentId:t,note:[e,n,a]}))))))))))}function It(e){const{instrumentId:t}=e,n=Ke()("track");return r.createElement("section",{className:n},r.createElement(gt,{instrumentId:t}),r.createElement(wt,{instrumentId:t}))}function xt(){const e=(0,s.v9)(fe),t=Ke()("tracks");return r.createElement("section",{className:t},e.map((e=>r.createElement(It,{key:e,instrumentId:e}))))}const kt=function(){return r.createElement("section",{className:"stepSequencer"},r.createElement(tt,null),r.createElement(xt,null))};var Et=n(3757),Nt={styleTagTransform:function(e,t){if(t.styleSheet)t.styleSheet.cssText=e;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(e))}},setAttributes:function(e){var t=n.nc;t&&e.setAttribute("nonce",t)},insert:function(e){var t=d()("head");if(!t)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");t.appendChild(e)}};function Ct(){const e=(0,s.v9)(xe),t=Ze();return r.createElement("section",{className:Ke()("sequencerInstruments")},r.createElement("p",{className:Ke()("instrumentListTitle")},"Staged Instruments"),r.createElement("ol",{className:Ke()("instrumentSelectList","right")},e.map((({uuid:e,name:n},a)=>r.createElement("li",{className:Ke()("instrumentListItem","sequencer"),key:e,onClick:()=>{t(ue(e))}},`${a+1}. ${n}`,r.createElement("div",{className:Ke()("spacer")}),r.createElement("button",{onClick:()=>t(oe(e))},"Unstage"))))))}function Pt(){const e=(0,s.v9)(we),t=(0,s.v9)(xe),n=e.filter((e=>!t.map((e=>e.uuid)).includes(e.uuid)));console.debug("DbInstrumentList dbInstruments:",e),console.debug("DbInstrumentList sequencerInstruments:",t),console.debug("DbInstrumentList availableInstruments:",n);const a=Ze();return r.createElement("section",{className:Ke()("availableInstruments")},r.createElement("p",{className:Ke()("instrumentListTitle")},"Available to add"),r.createElement("ol",{className:Ke()("instrumentSelectList","left")},n.map((({uuid:e,name:t},n)=>r.createElement("li",{className:Ke()("instrumentListItem","available"),key:e,onClick:()=>{a(ue(e))}},`${n+1}. ${t}`,r.createElement("div",{className:Ke()("spacer")}),r.createElement("button",{onClick:()=>{return a((t=e,async function(e,n){const r=Array.from(Ie(n())),a=await pe(t);return e(ie.actions.instrumentStaged(a)),r.push(t),e(de(r)),r}));var t}},"Stage"),r.createElement("button",{onClick:()=>{return a((t=e,console.debug("deleteInstrumentFromDb",t),async function(e){const n=await L.deleteInstrument(t);if(n.err)throw console.error("deleteInstrumentDb: got error deleting instrument",n.val),n.val;e(ie.actions.instrumentDeleted(t))}));var t}},"Delete"))))))}function St(){return console.debug("InstrumentSelect"),r.createElement("section",{className:Ke()("instrumentSelect")},r.createElement(Pt,null),r.createElement(Ct,null))}function At(){const[e,t]=r.useState([]),n=Ze();return r.createElement("section",null,r.createElement("label",null,"File(s)"),r.createElement("input",{type:"file",multiple:!0,onChange:async e=>{t(Array.from(e.target.files))}}),r.createElement("button",{disabled:0===e.length,onClick:()=>{e.map((async e=>{const t=await W.fromFile(e);n(se(t))})),t([])}},"Upload"))}function Ot(){return r.createElement("section",{className:Ke()()},r.createElement(St,null),r.createElement(At,null))}function Tt(e){const{onClick:t}=e;return r.useEffect((()=>(document.addEventListener("click",t,!1),()=>document.removeEventListener("click",t,!1))),[]),r.createElement("div",{className:Ke()("clickToStart"),onClick:t},r.createElement("p",null,"Click Anywhere to Start..."))}function qt(e,t){return t("pending"),e().then((e=>(t("fulfilled"),e))).catch((e=>{throw t("rejected"),e}))}Nt.domAPI=c(),Nt.insertStyleElement=f(),l()(Et.Z,Nt),Et.Z&&Et.Z.locals&&Et.Z.locals;const Bt=function(){const e=Ze(),[t,n]=r.useState(!1),[a,s]=r.useState("notStarted"),[o,l]=r.useState("notStarted");return t?r.createElement(i.mQ,null,r.createElement(i.td,null,r.createElement(i.OK,null,"Sequencer"),r.createElement(i.OK,null,"Instrument Builder")),r.createElement(i.x4,null,r.createElement(Ge,{status:o,ready:"fulfilled"===o},r.createElement(kt,null))),r.createElement(i.x4,null,r.createElement(Ge,{status:a,ready:"fulfilled"===a},r.createElement(Ot,null)))):r.createElement(Tt,{onClick:()=>{!async function(){console.log("initializing app"),await R.init(),qt((()=>e(ae()).unwrap()),l),qt((()=>e(re()).unwrap()),s).then((async t=>{0===t.length&&(console.debug("found no instruments in db. initializing default instruments"),await e((async function(e){console.debug("initializing default instruments");const t=await async function(){const e=[new X(new W("/assets/audio/shaker1.wav"),new W("/assets/audio/shaker2.wav")),new W("/assets/audio/hat.wav"),new W("/assets/audio/lazertom.wav"),new W("/assets/audio/electrotom.wav"),new W("/assets/audio/snare.wav"),new ne(new W("/assets/audio/kick.wav"),new J({name:"synth"}))];return await R.getTone().loaded(),e}(),n=t.map((e=>e.getUuid()));var r;await R.getTone().loaded(),t.forEach((t=>{e(se(t))})),e((r=n,async function(e){await e(ce(r)),await e(de(r))}))})))}))}(),n(!0)}})},jt=document.querySelector("#stepsequencer_container");a.render(r.createElement(s.zt,{store:Ve},r.createElement(Bt,null)),jt)},3894:e=>{function t(e,n,r,a){this.message=e,this.expected=n,this.found=r,this.location=a,this.name="SyntaxError","function"==typeof Error.captureStackTrace&&Error.captureStackTrace(this,t)}!function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}(t,Error),t.buildMessage=function(e,t){var n={literal:function(e){return'"'+a(e.text)+'"'},class:function(e){var t,n="";for(t=0;t<e.parts.length;t++)n+=e.parts[t]instanceof Array?s(e.parts[t][0])+"-"+s(e.parts[t][1]):s(e.parts[t]);return"["+(e.inverted?"^":"")+n+"]"},any:function(e){return"any character"},end:function(e){return"end of input"},other:function(e){return e.description}};function r(e){return e.charCodeAt(0).toString(16).toUpperCase()}function a(e){return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}function s(e){return e.replace(/\\/g,"\\\\").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/[\x00-\x0F]/g,(function(e){return"\\x0"+r(e)})).replace(/[\x10-\x1F\x7F-\x9F]/g,(function(e){return"\\x"+r(e)}))}return"Expected "+function(e){var t,r,a,s=new Array(e.length);for(t=0;t<e.length;t++)s[t]=(a=e[t],n[a.type](a));if(s.sort(),s.length>0){for(t=1,r=1;t<s.length;t++)s[t-1]!==s[t]&&(s[r]=s[t],r++);s.length=r}switch(s.length){case 1:return s[0];case 2:return s[0]+" or "+s[1];default:return s.slice(0,-1).join(", ")+", or "+s[s.length-1]}}(e)+" but "+function(e){return e?'"'+a(e)+'"':"end of input"}(t)+" found."},e.exports={SyntaxError:t,parse:function(e,n){n=void 0!==n?n:{};var r,a={},s={Start:J},i=J,o=function(e){return e.data},l="=",u=G("=",!1),c=function(e,t){const n=e.data;n in ie&&Z(`Variable "${n} already defined."`),ie[n]=t.data},m=function(e,t){return[e].concat(t.map((([e,t])=>t)).flat())},d="(",p=G("(",!1),f=")",h=G(")",!1),g=function(e){return e},y=function(e){const t=e.data;return t in ie||Z(`Variable "${t}" undefined.`),{type:"VARIABLE",variable:t,data:ie[t]}},b=function(e,t){const n=e.data;n in ue||Z(`Function ${n} not found`);const r=ue[n];r.argn>0&&t.length!=r.argn&&Z(`Function ${n} expected ${r.argn} args but got ${t.length}.`);const a={type:"FUNCTIONCALL",name:n,args:t,data:null};try{const e=r.fn.apply(null,t.map((e=>e.data)));a.data=e}catch(e){!function(e,t){console.log(`text:${e}\nnode:`,JSON.stringify(t,null,4))}(V(),a),Z(`Got error running function: ${e.message}`)}return a},v=/^[\-.]/,w=_(["-","."],!1,!1),I=function(e){return{type:"LITERAL",data:e.map((e=>"-"===e))}},x=function(e,t){const n={m:oe,h:oe/2,q:oe/4,e:oe/8,s:oe/16};return{type:"INTERVAL",data:e.data*n[t.data]}},k=/^[mhqes]/,E=_(["m","h","q","e","s"],!1,!1),N=function(){return{type:"UNIT",data:V()}},C=/^[a-z]/,P=_([["a","z"]],!1,!1),S=function(){return{type:"IDENTIFIER",data:V()}},A=K("integer"),O=/^[0-9]/,T=_([["0","9"]],!1,!1),q=function(){return{type:"INTEGER",data:parseInt(V(),10)}},B=K("whitespaceoptional"),j=/^[ \t\n\r]/,$=_([" ","\t","\n","\r"],!1,!1),L=K("whitespacerequired"),D=0,U=0,F=[{line:1,column:1}],R=0,M=[],z=0;if("startRule"in n){if(!(n.startRule in s))throw new Error("Can't start parsing from rule \""+n.startRule+'".');i=s[n.startRule]}function V(){return e.substring(U,D)}function Z(e,n){throw function(e,n){return new t(e,null,null,n)}(e,n=void 0!==n?n:W(U,D))}function G(e,t){return{type:"literal",text:e,ignoreCase:t}}function _(e,t,n){return{type:"class",parts:e,inverted:t,ignoreCase:n}}function K(e){return{type:"other",description:e}}function Y(t){var n,r=F[t];if(r)return r;for(n=t-1;!F[n];)n--;for(r={line:(r=F[n]).line,column:r.column};n<t;)10===e.charCodeAt(n)?(r.line++,r.column=1):r.column++,n++;return F[t]=r,r}function W(e,t){var n=Y(e),r=Y(t);return{start:{offset:e,line:n.line,column:n.column},end:{offset:t,line:r.line,column:r.column}}}function H(e){D<R||(D>R&&(R=D,M=[]),M.push(e))}function J(){var e,t,n,r;return e=D,ae()!==a?(t=D,n=function(){var e,t,n,r,s,i;if(e=D,(t=Q())!==a){for(n=[],r=D,(s=se())!==a&&(i=Q())!==a?r=s=[s,i]:(D=r,r=a);r!==a;)n.push(r),r=D,(s=se())!==a&&(i=Q())!==a?r=s=[s,i]:(D=r,r=a);n!==a?e=t=[t,n]:(D=e,e=a)}else D=e,e=a;return e}(),n!==a&&(r=se())!==a?t=n=[n,r]:(D=t,t=a),t===a&&(t=null),t!==a&&(n=ee())!==a&&(r=ae())!==a?(U=e,e=o(n)):(D=e,e=a)):(D=e,e=a),e}function Q(){var t,n,r,s;return t=D,(n=ne())!==a&&ae()!==a?(61===e.charCodeAt(D)?(r=l,D++):(r=a,0===z&&H(u)),r!==a&&ae()!==a&&(s=ee())!==a?(U=t,t=n=c(n,s)):(D=t,t=a)):(D=t,t=a),t}function X(){var e;return(e=ee())===a&&(e=function(){var e;return(e=function(){var e,t,n;return e=D,(t=re())!==a&&(n=te())!==a?(U=e,e=t=x(t,n)):(D=e,e=a),e}())===a&&(e=te())===a&&(e=re()),e}()),e}function ee(){var t,n,r,s;return t=function(){var t,n,r;if(t=D,n=[],v.test(e.charAt(D))?(r=e.charAt(D),D++):(r=a,0===z&&H(w)),r!==a)for(;r!==a;)n.push(r),v.test(e.charAt(D))?(r=e.charAt(D),D++):(r=a,0===z&&H(w));else n=a;return n!==a&&(U=t,n=I(n)),t=n}(),t===a&&(t=function(){var e,t,n;return e=D,(t=ne())!==a&&se()!==a?(n=function(){var e,t,n,r,s,i;if(e=D,(t=X())!==a){for(n=[],r=D,(s=se())!==a&&(i=X())!==a?r=s=[s,i]:(D=r,r=a);r!==a;)n.push(r),r=D,(s=se())!==a&&(i=X())!==a?r=s=[s,i]:(D=r,r=a);n!==a?(U=e,e=t=m(t,n)):(D=e,e=a)}else D=e,e=a;return e}(),n!==a?(U=e,e=t=b(t,n)):(D=e,e=a)):(D=e,e=a),e}(),t===a&&(t=function(){var e,t;return e=D,(t=ne())!==a&&(U=e,t=y(t)),e=t}(),t===a&&(t=D,40===e.charCodeAt(D)?(n=d,D++):(n=a,0===z&&H(p)),n!==a&&ae()!==a&&(r=ee())!==a&&ae()!==a?(41===e.charCodeAt(D)?(s=f,D++):(s=a,0===z&&H(h)),s!==a?(U=t,t=n=g(r)):(D=t,t=a)):(D=t,t=a)))),t}function te(){var t,n;return t=D,k.test(e.charAt(D))?(n=e.charAt(D),D++):(n=a,0===z&&H(E)),n!==a&&(U=t,n=N()),n}function ne(){var t,n,r;if(t=D,n=[],C.test(e.charAt(D))?(r=e.charAt(D),D++):(r=a,0===z&&H(P)),r!==a)for(;r!==a;)n.push(r),C.test(e.charAt(D))?(r=e.charAt(D),D++):(r=a,0===z&&H(P));else n=a;return n!==a&&(U=t,n=S()),n}function re(){var t,n,r;if(z++,t=D,n=[],O.test(e.charAt(D))?(r=e.charAt(D),D++):(r=a,0===z&&H(T)),r!==a)for(;r!==a;)n.push(r),O.test(e.charAt(D))?(r=e.charAt(D),D++):(r=a,0===z&&H(T));else n=a;return n!==a&&(U=t,n=q()),z--,(t=n)===a&&(n=a,0===z&&H(A)),t}function ae(){var t,n;for(z++,t=[],j.test(e.charAt(D))?(n=e.charAt(D),D++):(n=a,0===z&&H($));n!==a;)t.push(n),j.test(e.charAt(D))?(n=e.charAt(D),D++):(n=a,0===z&&H($));return z--,t===a&&(n=a,0===z&&H(B)),t}function se(){var t,n;if(z++,t=[],j.test(e.charAt(D))?(n=e.charAt(D),D++):(n=a,0===z&&H($)),n!==a)for(;n!==a;)t.push(n),j.test(e.charAt(D))?(n=e.charAt(D),D++):(n=a,0===z&&H($));else t=a;return z--,t===a&&(n=a,0===z&&H(L)),t}const ie={},oe=16;function le(e,t){return e.length<=t.length?[e,t]:[t,e]}const ue={all:{name:"all",aliases:[],argn:1,fn:e=>new Array(e).fill(!0)},empty:{name:"empty",aliases:[],argn:1,fn:e=>new Array(e).fill(!1)},down:{name:"down",aliases:["first"],argn:1,fn:e=>{const t=new Array(e).fill(!1);return t[0]=!0,t}},invert:{name:"invert",aliases:["inv"],argn:1,fn:e=>e.map((e=>!e))},reverse:{name:"reverse",aliases:["rv","rev"],argn:1,fn:e=>e.reverse()},repeat:{name:"repeat",aliases:["rpt"],argn:2,fn:(e,t)=>new Array(e).fill(t).flat()},repeatfill:{name:"repeatfill",aliases:["rptf"],argn:2,fn:(e,t)=>{const n=Math.ceil(e/t.length);return new Array(n).fill(t).flat().slice(0,e)}},rightshift:{name:"rightshift",aliases:["rs"],argn:2,fn:(e,t)=>{for(let n=0;n<e;n++)t.unshift(t.pop());return t}},leftshift:{name:"leftshift",aliases:["ls"],argn:2,fn:(e,t)=>{for(let n=0;n<e;n++)t.push(t.shift());return t}},fixedlength:{name:"fixedlength",aliases:["fl","truncate"],argn:2,fn:(e,t)=>e>t.length?t.concat(new Array(e-t.length).fill(!1)):t.slice(e)},bwand:{name:"bwand",aliases:["and"],argn:2,fn:(e,t)=>{const[n,r]=le(e,t),a=Array.from(r);return n.forEach(((e,t)=>{a[t]=a[t]&&e})),a}},bwor:{name:"bwor",aliases:["or"],argn:2,fn:(e,t)=>{const[n,r]=le(e,t),a=r;return n.forEach(((e,t)=>{a[t]=a[t]||e})),a}},bwxor:{name:"bwxor",aliases:["xor"],argn:2,fn:(e,t)=>{const[n,r]=le(e,t),a=r;return n.forEach(((e,t)=>{a[t]=(a[t]||e)&&!(a[t]&&e)})),a}},cat:{name:"cat",aliases:[],argn:-1,fn:(...e)=>e.flat()}};for(const[e,t]of Object.entries(ue))for(const e of t.aliases){if(e in ue)throw new Error(`Duplicate found while mapping aliases: ${e}`);ue[e]=t}if((r=i())!==a&&D===e.length)return r;throw r!==a&&D<e.length&&H({type:"end"}),ce=M,me=R<e.length?e.charAt(R):null,de=R<e.length?W(R,R+1):W(R,R),new t(t.buildMessage(ce,me),ce,me,de);var ce,me,de}}},4763:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(3645),a=n.n(r)()((function(e){return e[1]}));a.push([e.id,'html, body {\n  margin: 0px;\n  height: 100vh;\n}\n\n.stepSequencer {\n  display: block;\n  position: absolute;\n  background-color: #3b60a9;\n  border: 4px black;\n  height: 100vh;\n  width: 100vw;\n}\n\n.sequencerControls {\n  display: grid;\n  grid-template-columns: minmax(10px, 20vw) minmax(10px, 15vw) 1fr minmax(10px, auto) minmax(10px, auto);\n  grid-template-rows: auto;\n  grid-template-areas:\n    "bpm bar . play clear";\n  justify-items: center;\n  border: 1px solid black;\n  border-radius: 4px;\n  padding: 15px;\n}\n\n.slider.bpm {\n  grid-area: bpm;\n}\n\n.switch.nBars {\n  grid-area: bar;\n}\n\n.playButton {\n  grid-area: play;\n\n  display: inline-block;\n  border-radius: 28px;\n  color: #ffffff;\n  background: #d9ad34;\n  padding: 10px 20px 10px 20px;\n  text-decoration: none;\n}\n\n.clearAll {\n  grid-area: clear;\n\n  display: inline-block;\n  border-radius: 28px;\n  color: #ffffff;\n  background: #d9ad34;\n  padding: 10px 20px 10px 20px;\n  text-decoration: none;\n}\n\n.tracks {\n  display: block;\n}\n\n.track {\n  display: grid;\n  grid-template-columns: [icp-start] minmax(0, 1fr) [icp-end] 25px [pads-start] minmax(0, 5fr) [pads-end];\n  grid-template-rows: auto;\n}\n\n.fullControlPanel {\n  display: grid;\n  grid-template-columns: 1fr;\n  grid-template-rows: minmax(10px, auto) minmax(10px, auto) minmax(10px, 1fr);\n  grid-template-areas:\n    "label"\n    "rtm"\n    "parameters";\n  justify-items: stretch;\n\n  z-index: 42;\n  box-shadow: 5px 5px gray;\n  position: relative;\n  top: 20vh;\n  left: 20vw;\n  width: 40vw;\n  height: 40vh;\n  background-color: orange;\n  border: 1px solid black;\n  border-radius: 4px;\n}\n\n.quickControlPanel {\n  grid-column: icp-start / icp-end;\n\n  display: grid;\n  grid-template-columns: 15px minmax(0, 1fr) auto;\n  grid-template-rows: minmax(10px, auto) minmax(0px, 1fr);\n  grid-template-areas:\n    "rm label play"\n    "qc qc    qc";\n  justify-items: center;\n  align-items: center;\n  border: 1px solid black;\n  border-radius: 2px;\n}\n\n.removeInstrumentButton {\n  grid-area: rm;\n\n  display: inline;\n  padding: 5px;\n  background-color: transparent;\n  border: none;\n  border-radius: 2px;\n}\n\n.instrumentLabel {\n  grid-area: label;\n}\n\n.instrumentPlayButton {\n  display: inline;\n  grid-area: play;\n  margin: 3px 10px;\n}\n\n.quickControls {\n  display: inline;\n  grid-area: qc;\n}\n\n.quickControlButton {\n  display: inline;\n  margin: 3px 5px;\n}\n\n.quickControlButton.on {\n  border: 2px solid yellow;\n}\n\n.quickControlButton.off {\n}\n\n.rtmBox {\n  grid-area: "rtm";\n}\n\n.rtmInput {\n  font-family: monospace;\n}\n\n.rtmInput.invalid {\n  border: 2px solid red;\n}\n\n.instrumentParameters {\n  grid-area: parameters;\n}\n\n.slider {\n  display: inline-grid;\n  grid-template-columns: minmax(10px, 40%) minmax(10px, 60%);\n  grid-template-rows: auto;\n  grid-template-areas:\n    "label slider";\n  justify-items: start;\n}\n\n.slider.instrumentParameter {\n  display: grid;\n}\n\n.slider.instrumentParameter label {\n  grid-area: label;\n}\n\n.slider.instrumentParameter input {\n  grid-area: slider;\n  justify-self: center;\n  width: 80%\n}\n\n.pads {\n  grid-column: pads-start / pads-end;\n\n  display: grid;\n  grid-template-rows: auto;\n  column-gap: 6px;\n  justify-self: start;\n}\n\n.bar {\n  display: grid;\n  grid-template-rows: auto;\n  column-gap: 4px;\n}\n\n.beat > button:first-child {\n  border-color: orange;\n}\n\n.beat {\n  display: grid;\n  grid-template-rows: auto;\n  column-gap: 2px;\n}\n\n.pad {\n  display: inline-block;\n  border-radius: 2px;\n  padding: 15px 15px;\n  margin: 0px;\n  cursor: pointer;\n  border: 1px solid gray;\n}\n\n.pad.on {\n  background-color: #e5f523;\n}\n\n.pad.off {\n  background-color: #829bb1;\n}\n\n.pad.active {\n  border: 2px solid yellow;\n}\n',""]);const s=a},3757:(e,t,n)=>{n.d(t,{Z:()=>s});var r=n(3645),a=n.n(r)()((function(e){return e[1]}));a.push([e.id,'.instrumentSelect {\n  border: 1px solid black;\n  margin: 15px;\n\n  display: grid;\n  grid-template-columns: 50% 50%;\n  grid-template-rows: 100%;\n  grid-template-areas:\n    "available staged"\n}\n\n.availableInstruments {\n  grid-area: available;\n  border: 1px solid black;\n  margin: 2%;\n}\n\n.sequencerInstruments {\n  grid-area: staged;\n  border: 1px solid black;\n  margin: 2%;\n}\n\n.instrumentListTitle {\n  margin: 0px auto;\n}\n\n.instrumentListItem {\n  margin-right: 10%;\n}\n\n.instrumentListItem:hover {\n  border: 1px solid black;\n}\n\n.instrumentListItem#button {\n  width: fit-content;\n}\n\n.instrumentListItem.available {\n  display: grid;\n  grid-template-columns: minmax(10px, auto) 1fr minmax(10px, min-content) minmax(10px, min-content);\n  grid-template-rows: auto;\n  grid-template-areas: "label . stage delete";\n}\n\n.instrumentListItem.sequencer {\n  display: grid;\n  grid-template-columns: minmax(10px, auto) 1fr minmax(10px, min-content);\n  grid-template-rows: auto;\n  grid-template-areas: "label . unstage";\n}\n\n\n',""]);const s=a}},n={};function r(e){var a=n[e];if(void 0!==a)return a.exports;var s=n[e]={id:e,loaded:!1,exports:{}};return t[e].call(s.exports,s,s.exports,r),s.loaded=!0,s.exports}r.m=t,e=[],r.O=(t,n,a,s)=>{if(!n){var i=1/0;for(c=0;c<e.length;c++){for(var[n,a,s]=e[c],o=!0,l=0;l<n.length;l++)(!1&s||i>=s)&&Object.keys(r.O).every((e=>r.O[e](n[l])))?n.splice(l--,1):(o=!1,s<i&&(i=s));if(o){e.splice(c--,1);var u=a();void 0!==u&&(t=u)}}return t}s=s||0;for(var c=e.length;c>0&&e[c-1][2]>s;c--)e[c]=e[c-1];e[c]=[n,a,s]},r.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return r.d(t,{a:t}),t},r.d=(e,t)=>{for(var n in t)r.o(t,n)&&!r.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),(()=>{var e={136:0};r.O.j=t=>0===e[t];var t=(t,n)=>{var a,s,[i,o,l]=n,u=0;if(i.some((t=>0!==e[t]))){for(a in o)r.o(o,a)&&(r.m[a]=o[a]);if(l)var c=l(r)}for(t&&t(n);u<i.length;u++)s=i[u],r.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return r.O(c)},n=self.webpackChunkhngmn_github_io=self.webpackChunkhngmn_github_io||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))})(),r.nc=void 0;var a=r.O(void 0,[448,852,979,313],(()=>r(5785)));a=r.O(a)})();